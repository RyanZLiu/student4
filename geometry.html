<!-- … your existing front‑matter … -->
<html lang="en">
<head>
  <title>Find Area Using Shoelace Theorem</title>
  <!-- 1) Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    #chartContainer { width: 600px; height: 400px; margin: 1em auto; }
  </style>
</head>
<body>
  <h1>Find Area Using Shoelace Theorem</h1>
  <!-- … your forms and table as before … -->

  <!-- 2) Canvas for the plot -->
  <div id="chartContainer">
    <canvas id="chartCanvas"></canvas>
  </div>

  <p id="totalarea">The area of your polygon is 0.00</p>

  <script>
    // your existing X/Y arrays
    const xcoords = [], ycoords = [];

    // 3) Initialize the Chart.js scatter chart
    const ctx = document.getElementById('chartCanvas').getContext('2d');
    const chart = new Chart(ctx, {
      type: 'scatter',
      data: {
        datasets: [
          {
            label: 'Points',
            data: [],              // will be [{ x:…, y:… }, …]
            pointBackgroundColor: 'black',
            showLine: false,
          },
          {
            label: 'Polygon',
            data: [],              // same format
            showLine: true,
            fill: true,
            backgroundColor: 'rgba(173,216,230,0.4)',
            borderColor: 'steelblue',
            borderWidth: 1,
          }
        ]
      },
      options: {
        animation: false,
        scales: {
          x: { type: 'linear', position: 'bottom' },
          y: { type: 'linear' }
        }
      }
    });

    function addcoordinate() {
      const UserX = parseFloat(document.getElementById("xcoordinate").value),
            UserY = parseFloat(document.getElementById("ycoordinate").value);
      if (!isNaN(UserX) && !isNaN(UserY)) {
        xcoords.push(UserX);
        ycoords.push(UserY);
        updateTable();
        area();
        updateChart();    // <-- redraw your chart
      } else {
        alert("Please enter both X and Y as numbers.");
      }
    }

    function updateTable() {
      const table = document.querySelector("#coordinatesTable tbody");
      table.innerHTML = "";
      for (let i = 0; i < xcoords.length; i++) {
        const row = table.insertRow();
        row.insertCell(0).textContent = `(${xcoords[i]},`;
        row.insertCell(1).textContent = `${ycoords[i]})`;
      }
    }

    function area() {
      let a1 = 0, a2 = 0;
      for (let i = 0; i < xcoords.length - 1; i++) {
        a1 += xcoords[i] * ycoords[i+1];
        a2 += ycoords[i] * xcoords[i+1];
      }
      // close the loop
      a1 += xcoords[xcoords.length-1] * ycoords[0];
      a2 += ycoords[ycoords.length-1] * xcoords[0];
      const totalArea = 0.5 * Math.abs(a1 - a2);
      document.getElementById("totalarea").textContent =
        `The area of your polygon is ${totalArea.toFixed(2)}`;
    }

    // 4) updateChart will push new point, recompute bounds, and shade polygon
    function updateChart() {
      const ptsDataset = chart.data.datasets[0].data;
      const polyDataset = chart.data.datasets[1].data;

      // add latest point
      ptsDataset.push({ x: xcoords.at(-1), y: ycoords.at(-1) });

      // recompute axis limits with a small margin
      const allX = xcoords.slice(), allY = ycoords.slice();
      const xmin = Math.min(...allX), xmax = Math.max(...allX);
      const ymin = Math.min(...allY), ymax = Math.max(...allY);
      chart.options.scales.x.min = xmin - 0.5;
      chart.options.scales.x.max = xmax + 0.5;
      chart.options.scales.y.min = ymin - 0.5;
      chart.options.scales.y.max = ymax + 0.5;

      // if ≥3, build & fill the closed polygon
      if (xcoords.length >= 3) {
        polyDataset.length = 0;  // clear it
        xcoords.forEach((x,i) => polyDataset.push({ x, y: ycoords[i] }));
        // close it by repeating the first
        polyDataset.push({ x: xcoords[0], y: ycoords[0] });
      } else {
        polyDataset.length = 0;  // no fill until 3 points
      }

      chart.update();
    }
  </script>
</body>
</html>
